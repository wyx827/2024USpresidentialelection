---
title: "My title"
subtitle: "My subtitle if needed"
author: 
  - First author
  - Yongqi Liu
  - Yuxuan Wei
thanks: "Code and data are available at: [https://github.com/wyx827/2024USpresidentialelection.git]."
date: today
date-format: long
abstract: "First sentence. Second sentence. Third sentence. Fourth sentence."
format: pdf
number-sections: true
bibliography: references.bib
---

```{r}
#install.packages("tidymodels")
library(tidyverse)
library(ggplot2)
analysis_data <- read_csv(here::here("data/02-analysis_data/cleaned_US_voting.csv"))
```


# Introduction

Overview paragraph

Estimand paragraph

Results paragraph

Why it matters paragraph

Telegraphing paragraph: The remainder of this paper is structured as follows. @sec-data....



# Data {#sec-data}

## Overview

We use the statistical programming language R [@citeR].... Following @tellingstories, we consider...

Overview text

## Measurement
	
Some paragraphs about how we go from a phenomena in the world to an entry in the dataset.

## Outcome variables

Add graphs, tables and text. Use sub-sub-headings for each outcome variable or update the subheading to be singular.



Some of our data is of penguins (@fig-bills), 

```{r}
#| label: fig-bills
#| fig-cap: Bills of penguins
#| echo: false


```

Talk more about it.

And also planes (@fig-planes). (You can change the height and width, but don't worry about doing that until you have finished every other aspect of the paper - Quarto will try to make it look nice and the defaults usually work well once you have enough text.)

```{r}
#| label: fig-planes
#| fig-cap: Relationship between wing length and width
#| echo: false
#| warning: false
#| message: false


```

Talk way more about it. 

## Predictor variables

Add graphs, tables and text.

Use sub-sub-headings for each outcome variable and feel free to combine a few into one if they go together naturally.








# Model

To model Donald Trump’s polling percentages over time, we employed a Bayesian linear regression framework. Bayesian methods provide a flexible approach to inference by incorporating prior beliefs and updating them with observed data, allowing us to quantify uncertainty in both parameter estimates and predictions.

Here we briefly describe the Bayesian model used to investigate the winning probability of Trump. Background details and diagnostics are included in [Appendix -@sec-model-details].

## Multiple Linear Regression Model Overview
The model now predicts Trump’s polling percentage (percent) using the following predictors:

- Numeric Grade (numeric_grade): Reflects the quality rating of the pollster.
- Sample Size (sample_size): The number of respondents in the poll.
- State (state): A categorical variable for different U.S. states.
- Transparency Score (transparency_score): A measure of how transparent the polling data and methodology are.
- End Date (end_date): The date the poll was completed, which might capture trends over time.

The model takes the form:
The model takes the form:





# #Interpretation of Coefficients:

- Intercept (\beta_0): This is the predicted Trump polling percentage when all predictors (numeric grade, sample size, state, transparency score, and end date) are at their baseline or zero value.
- Numeric Grade (\beta_1): This coefficient measures how much Trump’s polling percentage changes as the pollster’s numeric grade increases. A positive and significant coefficient would indicate that higher-rated pollsters report better polling numbers for Trump, while a negative coefficient would suggest the opposite.
- Sample Size (\beta_2): This measures the impact of the number of respondents on Trump’s polling percentage. A positive coefficient would indicate that larger sample sizes are associated with higher polling percentages for Trump.
- State (\beta_3): The coefficients for the state variable represent differences in Trump’s polling percentage in each state compared to the reference state (baseline category). For example, if the coefficient for Florida is negative, it means Trump polls lower in Florida compared to the reference state.
- Transparency Score (\beta_4): This coefficient shows how much Trump’s polling percentage is affected by the transparency of the poll. A positive coefficient would indicate that polls with higher transparency tend to report higher polling percentages for Trump, whereas a negative coefficient would imply the opposite.
- End Date (\beta_5): The end date is a time-related variable, capturing trends over time. A positive and significant coefficient would suggest that Trump’s polling percentage has increased as the election date approaches, while a negative coefficient would suggest a decrease in his polling numbers over time.
	
	

## Interpretation
The posterior distributions of the parameters allow us to quantify the uncertainty around each effect:
- The coefficient for end_date informs us about how Trump’s polling percentages have evolved over time. A positive coefficient would suggest an upward trend, while a negative coefficient would indicate a decline.
- The coefficient for numeric_grade captures the impact of pollster quality on the polling percentage. High-quality pollsters may produce different estimates compared to lower-quality ones.
- The state-level effects account for regional differences in Trump’s support. Some states may show significantly higher or lower levels of support, even after adjusting for the time of the poll and pollster quality.




# Model Evalutation
- R-squared
@tbl-summary shows the summary table for the model. And then evaluate it on the test set. It appears as though the model is having difficulty identifying Trump supporters.
```{r}
#| echno: False
#| label: tbl-summary
#| tbl-cap: Relationship between wing length and width
#| echo: false
#| warning: false
#| message: false

library(knitr)
regression_model<-readRDS(here::here("models/regression_model.rds"))
summary<-summary(regression_model)
# Extract the coefficients (which can be formatted as a table)
coefficients_table <- summary$coefficients

# Display the coefficients table using kable
kable(coefficients_table, digits = 3, caption = "Regression Model Coefficients")
```




# Diagnostic plots for the model
```{r}
#| echno: false
#| label: fig-diagnosis
#| tbl-cap: Linear Regression Assumptions hold.
#| echo: false
#| warning: false
#| message: false

par(mfrow = c(2, 2))  
plot(regression_model)
```



```{r}
library(car)
vif(regression_model)
```




### Model justification

We expect a positive relationship between the size of the wings and time spent aloft. In particular...

We can use maths by including latex between dollar signs, for instance $\theta$.


# Results

## Predict and Combine with Electroal College to Predict

```{r tbl-prediction, echo=FALSE, warning=FALSE, message=FALSE}
#| echno: false
#| label: tbl-prediction
#| tbl-cap: Prediction for Trump
#| echo: false
#| warning: false
#| message: false

# Define electoral votes for each state
electoral_votes <- data.frame(
  state = c("Alabama", "Alaska", "Arizona", "Arkansas", "California", "Colorado", "Connecticut", "Delaware", "Florida", 
            "Georgia", "Hawaii", "Idaho", "Illinois", "Indiana", "Iowa", "Kansas", "Kentucky", "Louisiana", "Maine", 
            "Maine CD-1", "Maine CD-2", "Maryland", "Massachusetts", "Michigan", "Minnesota", "Mississippi", 
            "Missouri", "Montana", "Nebraska", "Nebraska CD-1", "Nebraska CD-2", "Nebraska CD-3", "Nevada", 
            "New Hampshire", "New Jersey", "New Mexico", "New York", "North Carolina", "North Dakota", "Ohio", 
            "Oklahoma", "Oregon", "Pennsylvania", "Rhode Island", "South Carolina", "South Dakota", "Tennessee", 
            "Texas", "Utah", "Vermont", "Virginia", "Washington", "West Virginia", "Wisconsin", "Wyoming", 
            "District of Columbia"),
  electoral_votes = c(9, 3, 11, 6, 55, 9, 7, 3, 29, 16, 4, 4, 20, 11, 6, 6, 8, 8, 2, 1, 1, 10, 11, 15, 10, 6, 10, 
                      3, 5, 1, 1, 2, 6, 4, 14, 5, 29, 16, 3, 18, 7, 6, 20, 4, 9, 3, 11, 38, 6, 3, 13, 12, 5, 10, 3, 3)
)

# Apply the regression model to predict Trump's percentage in each state
analysis_data$predicted_percent_trump <- predict(regression_model, newdata = analysis_data)

# Summarize Trump's predicted percentage for each state
total_trump <- aggregate(predicted_percent_trump ~ state, data = analysis_data, FUN = mean)

# Join electoral vote data with Trump's predictions
state_predictions <- merge(total_trump, electoral_votes, by = "state")

# Determine the winner for each state based on Trump’s predicted percentage
state_predictions$winner <- ifelse(state_predictions$predicted_percent_trump > 50, "Trump", "Harris")

# Create a table showing the prediction results
library(knitr)
kable(state_predictions, col.names = c("State", "Trump Predicted %", "Electoral Votes", "Winner"),
      digits = 2, caption = "Prediction for Trump by State")

# Print the results
print(paste("Trump Electoral Votes:", trump_electoral_votes))
print(paste("Harris Electoral Votes:", harris_electoral_votes))
```



```{r}
summary(regression_model)
```




# Discussion

## First discussion point {#sec-first-point}

If my paper were 10 pages, then should be be at least 2.5 pages. The discussion is a chance to show off what you know and what you learnt from all this. 

## Second discussion point

Please don't use these as sub-heading labels - change them to be what your point actually is.

## Third discussion point

## Weaknesses and next steps

Weaknesses and next steps should also be included.

\newpage

\appendix

# Appendix {-}

# Pollster Methodology Overview and Evaluation

## Overview of SurveyUSA\
SurveyUSA is a privately held opinion research company that operates nationwide, across all 50 U.S. states. Since its founding, the company has conducted over 40,000 research projects, serving a client base of 400 organizations, including media outlets, corporations, non-profits, government agencies, and academic institutions. Known for its expertise in localized opinion research, SurveyUSA focuses on gathering data at the city, county, and regional levels. The company offers timely, cost-effective surveys tailored to meet specific client needs, distinguishing itself from larger global firms.


## Population, Frame, and Sample\

* Target Population: U.S. citizens eligible to vote in the 2024 presidential election.\
* Sample Frame:  U.S. households with either home telephones or access to devices such as phones or tablets. \
* Sample Size: Sample sizes vary across different polls. For the 2024 U.S. presidential election cycle, SurveyUSA conducted 49 polls, with sample sizes ranging from 507 to 2,330 for registered voters or likely voters. The average sample size for these polls is approximately 1,045 households.\

## Recruitment\
SurveyUSA employs a mixed-method approach to recruitment, including online panels, telephone calls, and a text-to-web method. Some respondents are recruited through Random Digit Dialing (RDD) using telephone samples purchased from Aristotle, while others, who do not use home telephones, are invited to complete the survey on an electronic device such as a phone or tablet. Respondents from non-probability online panels are selected randomly by Cint/Lucid Holdings LLC.\

## Sampling approach and Trade-offs\
SurveyUSA uses a blend of probability and non-probability sampling methods. Some respondents are drawn from non-probability online panels, while others are recruited using probability-based telephone sampling. Responses are weighted based on the latest U.S. Census estimates for age, gender, ethnicity, and region, ensuring alignment with the target population. Questions and answer choices are rotated to reduce order bias, recency effects, and latency effects.\

* **Advantages:**\
The diverse sampling approach not only ensures a broad range of opinions is captured but also complements probability-based sampling, which accurately reflects the overall population. Furthermore, reweighting the data according to U.S. Census demographics strengthens the credibility of the results by ensuring demographic accuracy. Additionally, rotating questions and answer choices helps mitigate bias, further improving the reliability of the data. Finally, the use of online surveys offers a cost-effective solution for efficient data collection.\
* **Disadvantages:**\
Phone-based data collection tends to be time-consuming and can be affected by interviewer effects during telephone interviews. Additionally, challenges like non-response issues, such as busy signals or refusals to participate, can hinder the effectiveness of the data collection process.\

## Non-response Handling\
In cases of non-response, SurveyUSA attempts follow-up calls if interviews are interrupted by answering machines or busy signals. Weighting is applied to adjust for non-response bias, although this doesn't completely eliminate challenges posed by unreachable or unwilling participants.\

## Questionnaire Evaluation\

* **Positive Aspects:**
A logical flow between questions facilitates easy navigation for respondents throughout the survey, while simple wording promotes inclusivity by enabling individuals from diverse backgrounds to comprehend the questions. Furthermore, all questions are directly relevant to analyzing the 2024 U.S. presidential election, and providing predefined response options simplifies the choices for participants.\
* **Negative Aspects:**
Static options for party affiliation and ideology may fail to capture the nuances of respondents’ political beliefs. These rigid categories could oversimplify complex political identities.\

## Summary Evaluation\
SurveyUSA’s methodology reflects a balanced approach, leveraging various sampling approach and method to reach a representative sample. While its blend of probability and non-probability methods has strengths, such as cost-effectiveness and broad reach, it faces challenges related to telephone interview logistics, potential interviewer bias, and the limitations of fixed questionnaire options. Nevertheless, the inclusion of data weighting and question rotation adds credibility to its results, making SurveyUSA a reliable pollster for localized opinion research. 

# Appendix B: Idealized Methodology and Survey

## **Objective and Overview**
The goal of this survey methodology is to accurately forecast the outcome of the U.S. presidential election by collecting high-quality, representative data from a diverse set of respondents across the country. With a budget of $100,000, this methodology incorporates sophisticated sampling techniques, robust respondent recruitment strategies, and rigorous data validation protocols. The approach is designed to maximize accuracy, reduce bias, and account for various demographic, geographic, and political factors that influence voting behavior.

### **Core Objectives**:
1. Obtain a representative sample of the U.S. electorate.
2. Ensure data quality through rigorous validation.
3. Leverage statistical modeling and poll aggregation for an accurate prediction.

## **1. Sampling Strategy**

The sampling strategy is designed to ensure that the survey reaches a broad, representative section of the voting population. To achieve this, we will use **stratified random sampling** combined with **quota sampling** for key demographics. This ensures that each important subgroup within the population is adequately represented.

### **Stratification Variables**:
- **Age Groups**: 18-29, 30-44, 45-64, 65+  
- **Gender**: Male, Female, Non-binary/Other  
- **Race/Ethnicity**: White, Black, Hispanic/Latino, Asian, Indigenous, Other  
- **Education Level**: No high school, High school graduate, College graduate, Post-graduate  
- **Income Bracket**: <$30,000, $30,000-$60,000, $60,000-$100,000, >$100,000  
- **Geographic Region**: Northeast, Midwest, South, West  

**Sample Size**:  
A total of **10,000 respondents** will be surveyed, providing a margin of error of approximately ±1% at a 95% confidence level. This sample size will allow for detailed subgroup analysis (e.g., by state, demographic group), yielding statistically robust predictions.

**Weighting**:  
We will apply post-stratification weights to adjust for any oversampling or undersampling of specific demographic groups. For example, younger voters or underrepresented minorities will be weighted to reflect their true proportions in the voting population.

## **2. Recruitment Strategy**

### **Recruitment Channels**:
To maximize respondent diversity and ensure accurate sampling, the survey will employ **multi-channel recruitment**:

- **Digital Advertisements**: Targeted ads on platforms like Facebook, Instagram, and Google will be used to recruit respondents based on their demographic profiles (age, gender, location, political interest). Custom audience features will be utilized to reach specific demographic and geographic groups.
- **Email Outreach**: If permissible, we will access voter registration databases and send email invitations to registered voters. This will allow us to target specific voter demographics that are harder to reach via digital ads.
- **Partnerships with Civic Organizations**: Partnering with non-profits and civic organizations that engage diverse communities (e.g., minority voter outreach programs) will further boost respondent diversity.
- **Incentives**: To increase response rates, each participant will be entered into a lottery with a chance to win a $100 gift card, encouraging broader participation.

## **3. Data Validation and Quality Assurance**

Maintaining data integrity and ensuring high-quality responses are critical to the accuracy of the election forecast. Therefore, several measures will be put in place to validate responses and reduce noise in the dataset.

### **Data Validation Protocols**:
1. **Real-time Captcha Verification**: This will prevent automated bots from submitting responses.
2. **Email/Phone Verification**: Respondents will verify their email or phone number to ensure authenticity. This ensures that each respondent only participates once.
3. **Time on Task Monitoring**: The survey platform will monitor the time respondents spend on each question. Responses completed suspiciously quickly (e.g., below 30% of the average completion time) will be flagged for review or exclusion.
4. **Voter Registration Cross-Check**: If feasible, respondents will be cross-referenced with voter registration records to ensure they are eligible to vote in the upcoming election.
5. **Response Audits**: Randomly selected respondents will be contacted to verify the accuracy of their responses, ensuring integrity in the dataset.

## **4. Poll Aggregation and Data Analysis**

### **Poll Aggregation**:
This survey will be combined with results from reputable polling firms (e.g., YouGov, Ipsos, Gallup) to strengthen our forecast through a **poll-of-polls** approach.

- **Weighting by Methodology and Recency**: Poll results will be weighted based on the rigor of their methodology (e.g., online vs. phone surveys, sample size) and the recency of the poll. Recent, methodologically sound polls will receive more weight in the aggregation process.
- **Handling Bias and Variability**: Aggregated results will adjust for pollster house effects (biases in methodology) and variability between polls, ensuring that no single poll dominates the prediction.

### **Modeling Approach**:
We will implement **Bayesian hierarchical models** to account for variability across different states, demographics, and regions. This will allow us to model the popular vote and potentially translate it into **Electoral College predictions**.

## **5. Budget Allocation**

- **Respondent Recruitment (Targeted ads, outreach)**: $70,000  
- **Incentives (e.g., lottery prizes)**: $10,000  
- **Survey Platform (Google Forms, Qualtrics subscription)**: $5,000  
- **Data Validation Tools**: $5,000  
- **Poll Aggregation & Analysis Software**: $10,000  

---

## **6. Survey Implementation**

The survey will be implemented via **Google Forms**, which offers a cost-effective platform for data collection. The link to the live survey can be found here: [Google Form Survey](https://forms.gle/RC1464SvLvtoAYdv6). A copy of the questions is provided below.

### **Survey Structure**:

1. **Introduction**:
Thank you for taking part in this survey aimed at predicting the outcome of the 2024 US Presidential election. Your insights are valuable to our research.

Please note:
- **All responses will be kept strictly confidential.**
- **Your participation is entirely voluntary.**
- **We kindly request that you answer all questions honestly and to the best of your knowledge.**
- **The survey is estimated to take approximately 10 minutes to complete.**
If you have any inquiries or concerns regarding this survey, please don't hesitate to contact the research team at [shaw.wei@mail.utoronto.ca](mailto:shaw.wei@mail.utoronto.ca).

Your contribution to this study is greatly appreciated! Each participant will be entered into a lottery with a chance to win a $100 gift card!


2. **Section 1: Eligibility Screening**:
Are you a U.S. citizen?
- Yes
- No [If No, end survey]

Will you be 18 or older by Election Day (November 5, 2024)?
- Yes
- No [If No, end survey]

Are you registered to vote in the United States?
- Yes
- No
- Not sure
- Plan to register before the election


3. **Section 2: Demographic Information**:
What is your age group?
- 18-29
- 30-44
- 45-64
- 65 or older
- Prefer not to say

What is your gender?
- Male
- Female
- Non-binary/Other
- Prefer not to say

What is your race/ethnicity? (Select all that apply)
- White
- Black or African American
- Hispanic or Latino
- Asian
- American Indian or Alaska Native
- Native Hawaiian or Pacific Islander
- Prefer not to say
- Other: [Short text answer]

What is your highest level of education completed?
- No high school
- High school graduate or equivalent
- Some college, no degree
- Bachelor's degree
- Graduate or professional degree
- Prefer not to say

What was your total household income in 2023?
- Less than $30,000
- $30,000 - $59,999
- $60,000 - $99,999
- $100,000 - $149,999
- $150,000 or more
- Prefer not to say

In which region of the United States do you currently reside?
- Northeast (ME, NH, VT, MA, RI, CT, NY, NJ, PA)
- Midwest (OH, IN, IL, MI, WI, MN, IA, MO, ND, SD, NE, KS)
- South (DE, MD, DC, VA, WV, NC, SC, GA, FL, KY, TN, AL, MS, AR, LA, OK, TX)
- West (MT, ID, WY, CO, NM, AZ, UT, NV, WA, OR, CA, AK, HI)


4. **Section 3: Political Views and Voting Intentions**:
How likely are you to vote in the 2024 Presidential election?
- Definitely will vote
- Probably will vote
- Might or might not vote
- Probably will not vote
- Definitely will not vote

Generally speaking, do you usually think of yourself as a:
- Democrat
- Republican
- Independent
- Prefer not to say
- Other: [Short text answer]

If the 2024 Presidential election were held today, who would you vote for?
- Kamala Harris (Democrat)
- Donald Trump (Republican)
- Undecided
- Prefer not to say
- Other: [Short text answer]

How certain are you about your choice?
- Very certain
- Somewhat certain
- Not very certain
- Not at all certain
- Prefer not to say

Which THREE issues are most important to you in deciding your vote? (Select exactly three)
- Economy and jobs
- Healthcare
- Immigration
- Climate change
- National security
- Education
- Gun policy
- Social justice/racial equality
- Taxes
- Crime and public safety
- Foreign policy
- Other: [Short text answer]


5. **Section 4: Information Sources and Engagement**:

What is your primary source of political news? (Select all that apply)
- Network TV news (ABC, CBS, NBC)
- Cable TV news (CNN, Fox News, MSNBC)
- News websites
- Social media
- Radio
- Print newspapers
- Friends and family
- Other: [Short text answer]

How closely have you been following news about the 2024 Presidential election?
- Very closely
- Somewhat closely
- Not too closely
- Not at all
- Not sure


6. **Section 5: Validation and Consent**:
Please verify that you are a human by selecting "Blue" from the following options:
- Red
- Green
- Blue
- Yellow

Consent Statement:
"I understand that my participation in this survey is voluntary and that my responses will be kept confidential. I agree that my responses may be used for research purposes."
- Yes, I agree
- No, I do not agree

Email Address: [Email field]


7. **End Message**:
"Thank you for completing this survey. Your response has been recorded.
If you have any questions about this survey or would like to be informed about the results, please contact [Your Contact Information]."
    
---

### **7. Survey Design Considerations**

- **Question Wording**: All questions are carefully designed to avoid bias or leading responses.
- **Neutrality**: Political questions are framed neutrally to avoid pushing respondents toward specific answers.
- **Pilot Testing**: Before full deployment, the survey will undergo a pilot test to identify and resolve any issues.

---

This methodology, combining rigorous sampling, data validation, and aggregation, ensures that the election forecast is as accurate and representative as possible.

>>>>>>> 7bdf4d96b1910dc96b7cd995f3c7eccd50b162f4

# Additional data details

# Model details {#sec-model-details}

## Posterior predictive check


```{r}
#| eval: true
#| echo: false
#| message: false
#| warning: false
#| label: fig-ppcheckandposteriorvsprior
#| layout-ncol: 2
#| fig-cap: "Examining how the model fits, and is affected by, the data"
#| fig-subcap: ["Posterior prediction check", "Comparing the posterior with the prior"]


```

## Diagnostics



```{r}
#| echo: false
#| eval: true
#| message: false
#| warning: false
#| label: fig-stanareyouokay
#| fig-cap: "Checking the convergence of the MCMC algorithm"
#| fig-subcap: ["Trace plot", "Rhat plot"]
#| layout-ncol: 2
library(caret)
library(rstanarm)
library(ggplot2)
library(dplyr)
# Split the data into training (70%) and test (30%) sets
set.seed(853)  # For reproducibility


```


\newpage

# Acknowledgements
@citeR




# References


